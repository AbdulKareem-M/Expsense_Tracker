{% extends 'expenses/base.html' %}

{% block content %}
<h2>Your Budgets</h2>
<a href="{% url 'add_budget' %}" class="btn btn-primary mb-3">Add New Budget</a>

<div class="card mb-4">
  <div class="card-body">
    {% if budgets %}
    <table class="table table-striped">
      <thead>
        <tr>
          <th>Month</th>
          <th>Category</th>
          <th>Budget Amount</th>
          <th>Spent</th>
          <th>Remaining</th>
          <th>Progress</th>
        </tr>
      </thead>
      <tbody>
        {% for budget in budgets %}
        <tr>
          <td>{{ budget.month|date:"F Y" }}</td>
          <td>{{ budget.category.name }}</td>
          <td>${{ budget.amount }}</td>
          <td>${{ budget.spent|default:"0.00" }}</td>
          <td>${{ budget.remaining|default:budget.amount }}</td>
          <td>
            <div class="progress">
              <div class="progress-bar 
                {% if budget.progress >= 100 %}bg-danger
                {% elif budget.progress >= 75 %}bg-warning
                {% else %}bg-success
                {% endif %}" 
                role="progressbar" 
                style="width: {{ budget.progress|floatformat:0 }}%;"
                aria-valuenow="{{ budget.progress|floatformat:0 }}" 
                aria-valuemin="0" 
                aria-valuemax="100">
                {{ budget.progress|floatformat:0 }}%
              </div>

            </div>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    {% else %}
    <p>You don't have any budgets set up yet.</p>
    {% endif %}
  </div>
</div>
{% endblock %}